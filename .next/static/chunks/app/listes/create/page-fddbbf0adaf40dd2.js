(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[952],{783:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(5155),r=s(6874),l=s.n(r);function n(e){let{path:t}=e;return(0,a.jsx)("div",{children:(0,a.jsx)(l(),{href:t,className:"p-4",children:(0,a.jsx)("i",{className:"fa-solid fa-arrow-left-long text-3xl C-text-black","aria-hidden":"true"})})})}},1210:(e,t,s)=>{"use strict";s.d(t,{NI:()=>l,yW:()=>r,yb:()=>i});let{fetchData:a}=s(9360);async function r(e){try{let t=await a("/stock/".concat(e),{method:"GET"});return console.log("Stocks:",t),await t}catch(e){return null}}async function l(e,t){try{let s=await a("/stocks/".concat(e),{method:"PUT",body:JSON.stringify({stocks:t})});return await s}catch(e){return null}}async function n(e){try{let t=await a("/stocks",{method:"POST",body:JSON.stringify({stocks:e})});return await t}catch(e){return null}}async function i(e,t){try{let s=await r(e),a={};s.forEach(e=>{a[e.ID_product]=e});let i=[],c=[];return t.forEach(t=>{let s=parseInt(t.Quantity)*t.Box_quantity,r=a[t.ID_product];r?0===t.Packing?i.push({ID_product:t.ID_product,Quantity:r.Quantity+s,Nmb_boxes:r.Nmb_boxes+parseInt(t.Quantity),Nmb_on_shelves:r.Nmb_on_shelves}):i.push({ID_product:t.ID_product,Quantity:r.Quantity,Nmb_boxes:r.Nmb_boxes+parseInt(t.Quantity),Nmb_on_shelves:r.Nmb_on_shelves}):0===t.Packing?c.push({ID_product:t.ID_product,ID_store:e,Quantity:s,Nmb_boxes:parseInt(t.Quantity),Nmb_on_shelves:0}):c.push({ID_product:t.ID_product,ID_store:e,Quantity:0,Nmb_boxes:parseInt(t.Quantity),Nmb_on_shelves:0})}),i.length>0&&await l(e,i),c.length>0&&await n(c),await r(e)}catch(e){return console.error("Erreur lors de l'ajout au stock :",e),null}}},1756:(e,t,s)=>{"use strict";s.d(t,{b:()=>r});let{fetchData:a}=s(9360);async function r(e){try{let t=await a("/categoryEnable/".concat(e),{method:"GET"});return await t}catch(e){return null}}},3008:(e,t,s)=>{"use strict";s.d(t,{Bv:()=>l,D1:()=>n,I:()=>c,JR:()=>r,cd:()=>i});let{fetchData:a}=s(9360);async function r(e){try{let t=await a("/list/".concat(e),{method:"GET"});return await t}catch(e){return null}}async function l(e,t){try{let s=await a("/list/".concat(e,"/").concat(t),{method:"GET"});return await s}catch(e){return null}}async function n(e,t){let s={ID_store:e,products:Object.entries(t=Object.fromEntries(Object.entries(t).filter(e=>{let[t,s]=e;return s.items>0&&"N/A"!==s.items}))).map(e=>{let[t,s]=e;return{ID_product:parseInt(t),Quantity:s.items}})};try{console.log("Creating list with data:",s);let e=await a("/list",{method:"POST",body:JSON.stringify(s)});return await e}catch(e){return console.log("Error creating list:",e),null}}async function i(e,t){try{t=Object.fromEntries(Object.entries(t).filter(e=>{let[t,s]=e;return s>0&&"N/A"!==s}));let s=Object.entries(t).map(e=>{let[t,s]=e;return{ID_product:parseInt(t),Quantity:s}}),r=await a("/list",{method:"PUT",body:JSON.stringify({ID_list:e,products:s})});return await r}catch(e){return console.log("Error updating list:",e),null}}async function c(e){try{let t=await a("/list",{method:"DELETE",body:JSON.stringify({ID_list:e})});return await t}catch(e){return null}}},4689:(e,t,s)=>{Promise.resolve().then(s.bind(s,8774))},5068:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(5155);function r(){return(0,a.jsx)("div",{className:"h-[1px] w-[100%] C-bg-red-var2"})}},6713:(e,t,s)=>{"use strict";s.d(t,{U:()=>r});var a=s(2115);function r(e){let[t,s]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let t=window.matchMedia(e);s(t.matches);let a=e=>s(e.matches);return t.addEventListener("change",a),()=>t.removeEventListener("change",a)},[e]),t}},8774:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var a=s(5155),r=s(783),l=s(2115),n=s(1210),i=s(1756),c=s(9402),o=s(5068),d=s(6713);function u(e){let{stocks:t,list:s,setList:r}=e,[n,i]=(0,l.useState)(Array(t.length).fill(!1)),c=(e,t)=>{let a=[...n];if(a[e]=!a[e],i(a),a[e]){var l;let e=t.ID_product,a=(null===(l=s[e])||void 0===l?void 0:l.items)||0;r(t=>({...t,[e]:{...t[e],items:a+1}}))}},o=(e,t,s)=>{r(a=>{let{boxes:r,items:l}=a[e]||{boxes:0,items:0};return"boxes"===t?l=(r=Math.max(0,r+s))*d(e):r=Math.floor((l=Math.max(0,l+s))/d(e)),{...a,[e]:{boxes:r,items:l}}})},d=e=>{var s;return(null===(s=t.find(t=>t.ID_product===e))||void 0===s?void 0:s.product.Box_quantity)||1};return t&&0!==t.length?(0,a.jsx)("div",{className:"w-full flex flex-col items-center mt-2",children:(0,a.jsx)("div",{className:"w-[90%] flex flex-col items-center gap-2",children:t.map((e,t)=>{var r,l,i,u,x;let m=e.ID_product,h=d(m),f=(null===(r=s[m])||void 0===r?void 0:r.boxes)||0,p=(null===(l=s[m])||void 0===l?void 0:l.items)||0;return(0,a.jsxs)("div",{className:"bg-white w-[90%] flex rounded-[10px] border-[2px] C-border-red mb-2 overflow-hidden transition-all duration-300",children:[(0,a.jsxs)("div",{className:"w-[80%] flex gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center h-full w-[50%]",children:[(0,a.jsx)("div",{className:"flex items-center justify-center h-full gap-3 border-black border-r-[1px] w-[30%]",children:(0,a.jsx)("img",{src:e.product.Image||"/images/elements/default-product.jpg",alt:null===(i=e.product)||void 0===i?void 0:i.Label,className:"w-auto h-full rounded-[10px] object-cover"})}),(0,a.jsxs)("div",{className:"flex flex-col justify-between items-start w-[85%] h-[70%] py-3 px-2 pr-4",children:[(0,a.jsx)("p",{className:"C-text-black font-semibold text-xl",children:null===(u=e.product)||void 0===u?void 0:u.Label}),(0,a.jsx)("p",{className:"C-text-black font-normal text-sm",children:null===(x=e.product)||void 0===x?void 0:x.Barcode})]})]}),(0,a.jsx)("div",{className:"flex items-center gap-3 pl-5 text-lg justify-between w-[50%] p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-1 w-full justify-between",children:[0===e.product.Packing?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"fa-solid fa-cash-register text-2xl C-text-red"}),(0,a.jsx)("span",{className:"C-text-black font-bold",children:e.Nmb_on_shelves})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"fa-solid fa-box-open text-2xl C-text-red"}),(0,a.jsx)("input",{type:"checkbox",className:"w-5 h-5",disabled:!0,checked:1===e.product.Packing})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,a.jsx)("i",{className:"fa-solid fa-boxes-stacked C-text-red text-2xl"}),(0,a.jsx)("p",{className:"C-text-black font-bold",children:h})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"fa-solid fa-box text-2xl C-text-red"}),(0,a.jsx)("span",{className:"C-text-black font-bold",children:e.Nmb_boxes})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("i",{className:"fa-solid fa-dolly text-2xl C-text-red"}),(0,a.jsx)("span",{className:"C-text-black font-bold",children:e.Quantity})]})]})})]}),(0,a.jsx)("div",{className:"C-border-red-var2 border-l-[1px] p-4 w-[20%] min-w-max h-full",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"fa-solid fa-box text-2xl C-text-red"}),(0,a.jsx)("button",{className:"C-bg-red w-[4vh] h-[4vh] text-white rounded-xl",onClick:()=>o(m,"boxes",-1),children:"-1"}),(0,a.jsx)("input",{name:"QuantityBoxes",type:"number",className:"text-center text-xl font-bold C-text-black border w-[5vh] h-[5vh] C-border-red rounded-xl",value:f,onChange:e=>o(m,"boxes",e.target.value-f)}),(0,a.jsx)("button",{className:"C-bg-red w-[4vh] h-[4vh] text-white rounded-xl",onClick:()=>o(m,"boxes",1),children:"+1"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"fa-solid fa-dolly text-2xl C-text-red"}),0===e.product.Packing?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:"C-bg-red w-[4vh] h-[4vh] text-white rounded-xl",onClick:()=>o(m,"items",-1),children:"-1"}),(0,a.jsx)("input",{name:"QuantityItems",type:"number",onChange:e=>o(m,"items",e.target.value-p),className:"text-center text-xl font-bold C-text-black border w-[5vh] h-[5vh] C-border-red rounded-xl",value:p}),(0,a.jsx)("button",{className:"C-bg-red w-[4vh] h-[4vh] text-white rounded-xl",onClick:()=>o(m,"items",1),children:"+1"})]}):(0,a.jsxs)("label",{className:"relative inline-flex items-center gap-3 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:n[t],onChange:()=>c(t,e),className:"sr-only"}),(0,a.jsx)("div",{className:"w-[4vh] h-[4vh] rounded-xl border-2 flex items-center justify-center transition-all duration-200 ".concat(n[t]?"C-bg-red C-border-red":"C-border-red"),children:n[t]&&(0,a.jsx)("div",{className:"w-3 h-3 rounded-full bg-white"})})]})]})]})})]},m)})})}):(0,a.jsx)("p",{className:"text-white text-center",children:"Aucun produit trouv\xe9."})}function x(e){let{stocks:t,list:s,setList:r}=e,[n,i]=(0,l.useState)(null),c=e=>i(t=>t===e?null:e),[o,d]=(0,l.useState)(Array(t.length).fill(!1)),u=(e,t)=>{let a=[...o];if(a[e]=!a[e],d(a),a[e]){var l;let e=t.ID_product,a=(null===(l=s[e])||void 0===l?void 0:l.items)||0;r(t=>({...t,[e]:{...t[e],items:a+1}}))}},x=(e,t,s)=>{r(a=>{let{boxes:r,items:l}=a[e]||{boxes:0,items:0};return"boxes"===t?l=(r=Math.max(0,r+s))*m(e):r=Math.floor((l=Math.max(0,l+s))/m(e)),{...a,[e]:{boxes:r,items:l}}})},m=e=>{var s;return(null===(s=t.find(t=>t.ID_product===e))||void 0===s?void 0:s.product.Box_quantity)||1};return t&&0!==t.length?(0,a.jsx)("div",{className:"w-full flex flex-col justify-start items-center mt-2",children:t.map((e,t)=>{var r,l,i,d,h;let f=e.ID_product,p=m(f),b=(null===(r=s[f])||void 0===r?void 0:r.boxes)||0,v=(null===(l=s[f])||void 0===l?void 0:l.items)||0;return(0,a.jsxs)("div",{className:"bg-white w-[90%] rounded-[10px] border-[2px] C-border-red mb-2 overflow-hidden transition-all duration-300",children:[(0,a.jsxs)("div",{className:"flex cursor-pointer h-[8vh] min-h-max",onClick:()=>{c(e.ID_stock)},children:[(0,a.jsx)("div",{className:"flex items-center justify-center h-full gap-3 w-[15%]",children:(0,a.jsx)("img",{src:e.product.Image||"/images/elements/default-product.jpg",alt:null===(i=e.product)||void 0===i?void 0:i.Label,className:"w-auto h-auto rounded-[10px] object-cover"})}),(0,a.jsxs)("div",{className:"flex justify-between border-black border-l-[1px] items-center w-[85%] h-full py-3 px-2 pr-4",children:[(0,a.jsxs)("div",{className:"w-[60%]",children:[(0,a.jsx)("p",{className:"C-text-black font-semibold text-xl",children:null===(d=e.product)||void 0===d?void 0:d.Label}),(0,a.jsx)("p",{className:"C-text-black font-normal text-sm",children:null===(h=e.product)||void 0===h?void 0:h.Barcode})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center gap-3 text-lg justify-between w-[50%]",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 w-full justify-between",children:[0===e.product.Packing?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"fa-solid fa-cash-register text-2xl C-text-red"}),(0,a.jsx)("span",{className:"C-text-black font-bold",children:e.Nmb_on_shelves})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"fa-solid fa-box-open text-2xl C-text-red"}),(0,a.jsx)("input",{type:"checkbox",className:"w-5 h-5",disabled:!0,checked:1===e.product.Packing})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,a.jsx)("i",{className:"fa-solid fa-boxes-stacked C-text-red text-2xl"}),(0,a.jsx)("p",{className:"C-text-black font-bold ",children:p})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 w-full justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("i",{className:"fa-solid fa-box text-2xl C-text-red"}),(0,a.jsxs)("span",{className:"C-text-black font-bold",children:[e.Nmb_boxes,0===e.product.Packing&&e.Nmb_boxes*e.product.Box_quantity!==e.Quantity&&(0,a.jsx)("span",{className:"ml-1",children:"(1)"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("i",{className:"fa-solid fa-dolly text-2xl C-text-red"}),(0,a.jsx)("span",{className:"C-text-black font-bold",children:e.Quantity})]})]})]})]})]}),(0,a.jsx)("div",{className:"transition-all duration-300 ease-in-out overflow-hidden C-border-red-var2 border-t-[1px] ".concat(n===e.ID_stock?"max-h-[200px] opacity-100":"max-h-0 opacity-0"),children:(0,a.jsx)("div",{className:"flex justify-around items-center px-2 py-3 border-t C-border-light",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,a.jsx)("i",{className:"fa-solid fa-box text-2xl C-text-red"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>x(f,"boxes",-1),className:"C-bg-red w-[8vw] h-[8vw] text-white px-2 py-1 rounded-xl",children:"-1"}),(0,a.jsx)("input",{type:"number",className:"text-center text-xl font-bold C-text-black border w-[10vw] h-[10vw] C-border-red rounded-xl",value:b,onChange:e=>x(f,"boxes",e.target.value-b)}),(0,a.jsx)("button",{onClick:()=>x(f,"boxes",1),className:"C-bg-red w-[8vw] h-[8vw] text-white px-2 py-1 rounded-xl",children:"+1"})]}),(0,a.jsx)("i",{className:"fa-solid fa-dolly text-2xl C-text-red"}),0===e.product.Packing?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>x(f,"items",-1),className:"C-bg-red w-[8vw] h-[8vw] text-white px-2 py-1 rounded-xl",children:"-1"}),(0,a.jsx)("input",{type:"number",className:"text-center text-xl font-bold C-text-black border w-[10vw] h-[10vw] C-border-red rounded-xl",value:v,onChange:e=>x(f,"items",e.target.value-v)}),(0,a.jsx)("button",{onClick:()=>x(f,"items",1),className:"C-bg-red w-[8vw] h-[8vw] text-white px-2 py-1 rounded-xl",children:"+1"})]}):(0,a.jsxs)("label",{className:"relative inline-flex items-center gap-3 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:o[t],onChange:()=>u(t,e),className:"sr-only"}),(0,a.jsx)("div",{className:"w-[8vw] h-[8vw] rounded-xl border-2 flex items-center justify-center transition-all duration-200 ".concat(o[t]?"C-bg-red C-border-red":"C-border-red"),children:o[t]&&(0,a.jsx)("div",{className:"w-3 h-3 rounded-full bg-white"})})]})]})})})]},e.ID_stock)})}):(0,a.jsx)("p",{className:"text-white text-center",children:"Aucun produit trouv\xe9."})}var m=s(3008);function h(){let[e,t]=(0,l.useState)([]),[s,h]=(0,l.useState)([]),[f,p]=(0,l.useState)([]),[b,v]=(0,l.useState)(null),[j,N]=(0,l.useState)(0),[w,y]=(0,l.useState)(0),[g,C]=(0,l.useState)(""),[k,_]=(0,l.useState)({}),I=(0,d.U)("(max-width: 768px)"),{user:D}=(0,c.A)();(0,l.useEffect)(()=>{(async()=>{if(D&&D.ID_store){var e;let s=await (0,n.yW)(D.ID_store),a=await (0,i.b)(D.ID_store);t(s),p(a),v(null===(e=a[0])||void 0===e?void 0:e.ID_category)}})()},[D]),(0,l.useEffect)(()=>{S()},[b,j,w,g,e]);let S=()=>{if(!b)return;let t=e.filter(e=>{var t;return(null===(t=e.product)||void 0===t?void 0:t.ID_category)===b});g&&(t=t.filter(e=>{var t,s;return(null===(t=e.product)||void 0===t?void 0:t.Barcode.startsWith(g))||(null===(s=e.product)||void 0===s?void 0:s.Label.toLowerCase().includes(g.toLowerCase()))})),0!==j&&t.sort((e,t)=>1===j?e.product.Label.localeCompare(t.product.Label):t.product.Label.localeCompare(e.product.Label)),0!==w&&t.sort((e,t)=>1===w?e.Quantity-t.Quantity:t.Quantity-e.Quantity),h(t)},E=["#FF6384","#36A2EB","#FFCE56","#4CAF50","#9C27B0"],Q=async()=>{await (0,m.D1)(D.ID_store,k)&&(window.location.href="/listes")};return(0,a.jsxs)("div",{className:"flex flex-col gap-[3vh] items-center justify-start relative z-10 w-[100%] h-[100%] p-5",children:[(0,a.jsx)("div",{className:"w-[100%]",children:(0,a.jsx)(r.A,{path:"/listes"})}),(0,a.jsx)("div",{className:"w-full flex items-center justify-end px-5 py-3",children:(0,a.jsx)("div",{className:" C-text-red font-bold text-xl cursor-pointer C-bg-red-var2 rounded-full px-10 py-2",onClick:Q,children:"Cr\xe9er"})}),(0,a.jsx)("div",{className:"flex items-center justify-start gap-3 w-[100%] px-4 overflow-x-auto h-[10vh] min-h-min scrollbar-hide",children:f.map((e,t)=>(0,a.jsx)("button",{onClick:()=>v(e.ID_category),className:"p-4 text-xl rounded-[20px] border-b-[5px] cursor-pointer transition-all bg-white ".concat(b===e.ID_category?"!border-red-500 text-red-500 ":"border-gray-300 C-text-black "),style:{borderColor:E[t%E.length]},children:e.category.Label},e.ID_category))}),(0,a.jsxs)("div",{className:"flex items-center justify-around sm:justify-end sm:gap-8 w-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-start w-[60%] sm:w-auto gap-2",children:[(0,a.jsxs)("button",{onClick:()=>N(e=>1===e?-1:+(-1!==e)),className:"flex items-center gap-2 cursor-pointer text-black px-3 py-2",children:[1===j?(0,a.jsx)("i",{className:"fas fa-sort-up","aria-hidden":"true"}):-1===j?(0,a.jsx)("i",{className:"fas fa-sort-down","aria-hidden":"true"}):(0,a.jsx)("i",{className:"fas fa-sort","aria-hidden":"true"}),"Par nom"]}),(0,a.jsxs)("button",{onClick:()=>y(e=>1===e?-1:+(-1!==e)),className:"flex items-center gap-2 cursor-pointer text-black px-3 py-2",children:[1===w?(0,a.jsx)("i",{className:"fas fa-sort-up","aria-hidden":"true"}):-1===w?(0,a.jsx)("i",{className:"fas fa-sort-down","aria-hidden":"true"}):(0,a.jsx)("i",{className:"fas fa-sort","aria-hidden":"true"}),"Par quantit\xe9"]})]}),(0,a.jsxs)("div",{className:"relative w-[40%] sm:w-[20%] flex items-center ",children:[(0,a.jsx)("input",{type:"text",placeholder:"Recherche",value:g,onChange:e=>C(e.target.value),className:"px-4 py-2 C-border-red-var2 border-[1px] text-sm w-full rounded-full text-black shadow-md"}),(0,a.jsx)("i",{className:"fas fa-search absolute right-3 top-3 C-text-red","aria-hidden":"true"})]})]}),(0,a.jsx)(o.A,{}),(0,a.jsx)("div",{className:"w-full h-full flex flex-col justify-start items-center mt-2",children:0===s.length?(0,a.jsx)("p",{className:"text-white text-center",children:"Aucun produit trouv\xe9."}):I?(0,a.jsx)(x,{stocks:s,list:k,setList:_}):(0,a.jsx)(u,{stocks:s,list:k,setList:_})})]})}},9142:(e,t,s)=>{"use strict";s.d(t,{O5:()=>i,QF:()=>o,c4:()=>c,iD:()=>n});var a=s(7383);let{fetchData:r}=s(9360),l="auth_token";async function n(e,t){try{let s=await r("/login",{method:"POST",body:JSON.stringify({Name:e,Password:t})});return i(s.token),await s}catch(e){return null}}function i(e){a.A.set(l,e,{expires:1,sameSite:"Strict"}),a.A.set("pendingProducts",[])}function c(){return a.A.get(l)}function o(){a.A.remove(l)}},9360:(e,t,s)=>{"use strict";s.r(t),s.d(t,{fetchData:()=>r});var a=s(9142);async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let s=(0,a.c4)(),r=await fetch("".concat("https://relay-api.mathis-mercier.mds-angers.yt/api").concat(e),{...t,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:s?"Bearer ".concat(s):""},credentials:"include"});if(!r.ok)throw Error("Erreur HTTP! Statut: ".concat(r.status));return r.json()}catch(e){return null}}},9402:(e,t,s)=>{"use strict";s.d(t,{A:()=>o,O:()=>c});var a=s(5155),r=s(2115),l=s(9142),n=s(5695);let i=(0,r.createContext)();function c(e){let{children:t}=e,[s,c]=(0,r.useState)(null),[o,d]=(0,r.useState)((0,l.c4)()),u=(0,n.useRouter)();(0,r.useEffect)(()=>{{let e=localStorage.getItem("user");e&&c(JSON.parse(e))}},[]),(0,r.useEffect)(()=>{o||u.push("/login")},[o]);let x=async(e,t)=>{let s=await (0,l.iD)(e,t);s&&s.token&&((0,l.O5)(s.token),c(s.user),d(s.token),localStorage.setItem("user",JSON.stringify(s.user)),u.push("/"))};return(0,a.jsx)(i.Provider,{value:{user:s,token:o,login:x,logout:()=>{(0,l.QF)(),c(null),d(null),localStorage.removeItem("user"),u.push("/login")}},children:t})}function o(){return(0,r.useContext)(i)}}},e=>{var t=t=>e(e.s=t);e.O(0,[806,441,684,358],()=>t(4689)),_N_E=e.O()}]);