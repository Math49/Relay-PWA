(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[595],{783:(t,e,r)=>{"use strict";r.d(e,{A:()=>i});var s=r(5155),a=r(6874),n=r.n(a);function i(t){let{path:e}=t;return(0,s.jsx)("div",{children:(0,s.jsx)(n(),{href:e,className:"p-4",children:(0,s.jsx)("i",{className:"fa-solid fa-arrow-left-long text-3xl C-text-black","aria-hidden":"true"})})})}},1427:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>f});var s=r(5155),a=r(783),n=r(2115),i=r(9402),l=r(3008),c=r(3727),o=r(6874),u=r.n(o),d=r(5695);function f(){let{user:t}=(0,i.A)(),[e,r]=(0,n.useState)([]),o=(0,d.useRouter)();return(0,n.useEffect)(()=>{(async()=>{if(t&&t.ID_store){let e=await (0,l.JR)(t.ID_store);e.forEach(t=>{t.Creation_date=new Date(t.Creation_date).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}),t.Creation_date=t.Creation_date.replace(/\//g,"/")}),r(e)}})()},[t]),(0,s.jsxs)("div",{className:"flex flex-col gap-[3vh] items-center justify-start relative z-10 text-white w-[100%] h-[100%] p-5",children:[(0,s.jsx)("div",{className:"w-[100%]",children:(0,s.jsx)(a.A,{path:"/"})}),(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("div",{className:"w-full flex items-center justify-end px-5 py-3",children:(0,s.jsx)(u(),{href:"/listes/create",className:" C-text-white font-bold text-xl cursor-pointer C-bg-red rounded-full px-10 py-2",children:"Cr\xe9er une liste"})}),(0,s.jsx)("div",{className:"flex flex-col sm:flex-row items-center sm:flex-wrap gap-4 justify-start p-5 w-full",children:e.length>0?e.map(t=>(0,s.jsxs)("div",{className:"flex items-center sm:flex-col cursor-pointer sm:justify-center justify-between w-[100%] sm:w-[24%] sm:h-[24vh] h-[12vh] C-bg-red-var2 rounded-[20px] px-6 py-3 overflow-hidden relative",onClick:()=>o.push("/listes/"+t.ID_list),children:[(0,s.jsxs)("p",{className:"C-text-black font-bold text-2xl",children:["Liste N\xb0",t.ID_list]}),(0,s.jsx)("div",{className:"h-full sm:h-auto flex items-end",children:(0,s.jsx)("p",{className:"C-text-black ",children:t.Creation_date})}),(0,s.jsx)("img",{src:"/images/elements/barcode_var2.svg",className:"absolute w-[25vw] right-[40vw] sm:right-[2vw] sm:w-[10vw] bottom-0 z-10"})]},t.ID_list)):(0,s.jsx)("div",{className:"flex items-center justify-center w-full h-full",children:(0,s.jsx)("p",{className:"C-text-black font-bold text-2xl",children:"Aucune liste cr\xe9\xe9e"})})})]}),(0,s.jsx)(c.A,{})]})}},3008:(t,e,r)=>{"use strict";r.d(e,{Bv:()=>n,D1:()=>i,I:()=>c,JR:()=>a,cd:()=>l});let{fetchData:s}=r(9360);async function a(t){try{let e=await s("/list/".concat(t),{method:"GET"});return await e}catch(t){return null}}async function n(t,e){try{let r=await s("/list/".concat(t,"/").concat(e),{method:"GET"});return await r}catch(t){return null}}async function i(t,e){let r={ID_store:t,products:Object.entries(e=Object.fromEntries(Object.entries(e).filter(t=>{let[e,r]=t;return r.items>0&&"N/A"!==r.items}))).map(t=>{let[e,r]=t;return{ID_product:parseInt(e),Quantity:r.items}})};try{console.log("Creating list with data:",r);let t=await s("/list",{method:"POST",body:JSON.stringify(r)});return await t}catch(t){return console.log("Error creating list:",t),null}}async function l(t,e){try{e=Object.fromEntries(Object.entries(e).filter(t=>{let[e,r]=t;return r>0&&"N/A"!==r}));let r=Object.entries(e).map(t=>{let[e,r]=t;return{ID_product:parseInt(e),Quantity:r}}),a=await s("/list",{method:"PUT",body:JSON.stringify({ID_list:t,products:r})});return await a}catch(t){return console.log("Error updating list:",t),null}}async function c(t){try{let e=await s("/list",{method:"DELETE",body:JSON.stringify({ID_list:t})});return await e}catch(t){return null}}},3727:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var s=r(5155);function a(){return(0,s.jsx)("div",{className:"w-[100vw] C-bg-white flex items-center justify-center my-[2vh]",children:(0,s.jsx)("div",{className:"w-[30px] h-[30px] C-bg-red rounded-full p-1.5",children:(0,s.jsx)("img",{src:"/images/elements/logo-relay.svg",className:"w-[100%] h-[100%]"})})})}},4651:(t,e,r)=>{Promise.resolve().then(r.bind(r,1427))},9142:(t,e,r)=>{"use strict";r.d(e,{O5:()=>l,QF:()=>o,c4:()=>c,iD:()=>i});var s=r(7383);let{fetchData:a}=r(9360),n="auth_token";async function i(t,e){try{let r=await a("/login",{method:"POST",body:JSON.stringify({Name:t,Password:e})});return l(r.token),await r}catch(t){return null}}function l(t){s.A.set(n,t,{expires:1,sameSite:"Strict"}),s.A.set("pendingProducts",[])}function c(){return s.A.get(n)}function o(){s.A.remove(n)}},9360:(t,e,r)=>{"use strict";r.r(e),r.d(e,{fetchData:()=>a});var s=r(9142);async function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=(0,s.c4)(),a=await fetch("".concat("https://relay-api.mathis-mercier.mds-angers.yt/api").concat(t),{...e,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:r?"Bearer ".concat(r):""},credentials:"include"});if(!a.ok)throw Error("Erreur HTTP! Statut: ".concat(a.status));return a.json()}catch(t){return null}}},9402:(t,e,r)=>{"use strict";r.d(e,{A:()=>o,O:()=>c});var s=r(5155),a=r(2115),n=r(9142),i=r(5695);let l=(0,a.createContext)();function c(t){let{children:e}=t,[r,c]=(0,a.useState)(null),[o,u]=(0,a.useState)((0,n.c4)()),d=(0,i.useRouter)();(0,a.useEffect)(()=>{{let t=localStorage.getItem("user");t&&c(JSON.parse(t))}},[]),(0,a.useEffect)(()=>{o||d.push("/login")},[o]);let f=async(t,e)=>{let r=await (0,n.iD)(t,e);r&&r.token&&((0,n.O5)(r.token),c(r.user),u(r.token),localStorage.setItem("user",JSON.stringify(r.user)),d.push("/"))};return(0,s.jsx)(l.Provider,{value:{user:r,token:o,login:f,logout:()=>{(0,n.QF)(),c(null),u(null),localStorage.removeItem("user"),d.push("/login")}},children:e})}function o(){return(0,a.useContext)(l)}}},t=>{var e=e=>t(t.s=e);t.O(0,[806,441,684,358],()=>e(4651)),_N_E=t.O()}]);