(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[823],{783:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(5155),s=a(6874),l=a.n(s);function i(e){let{path:t}=e;return(0,r.jsx)("div",{children:(0,r.jsx)(l(),{href:t,className:"p-4",children:(0,r.jsx)("i",{className:"fa-solid fa-arrow-left-long text-3xl C-text-black","aria-hidden":"true"})})})}},1756:(e,t,a)=>{"use strict";a.d(t,{b:()=>s});let{fetchData:r}=a(9360);async function s(e){try{let t=await r("/categoryEnable/".concat(e),{method:"GET"});return await t}catch(e){return null}}},3179:(e,t,a)=>{"use strict";a.d(t,{W:()=>l,d:()=>s});let{fetchData:r}=a(9360);async function s(){try{let e=await r("/products",{method:"GET"});return await e}catch(e){return null}}async function l(e){try{let t=await r("/product",{method:"POST",body:JSON.stringify(e)});return await t}catch(e){return null}}},7936:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var r=a(5155),s=a(6874),l=a.n(s),i=a(2115),n=a(783),c=a(1756),o=a(9402),d=a(1802),u=a(3179);function x(e){let{closeModal:t}=e,{user:a}=(0,o.A)(),[s,l]=(0,i.useState)(null),[n,x]=(0,i.useState)([]),[m,h]=(0,i.useState)({Label:"",Barcode:"",Box_quantity:0,Packing:!1,ID_category:0,Image:null}),f=(0,i.useRef)();(0,i.useEffect)(()=>{(async()=>{a&&a.ID_store&&x(await (0,c.b)(a.ID_store))})()},[]);let g=async e=>{let t=e.target.files[0];if(t)try{let e=await (0,d.A)(t,{maxSizeMB:.2,maxWidthOrHeight:640,useWebWorker:!0});h(t=>({...t,image:e}));let a=new FileReader;a.onloadend=()=>{l(a.result)},a.readAsDataURL(e)}catch(e){console.error("Erreur compression image:",e)}},v=async e=>{e.preventDefault();let a=null;m.image&&(a=await new Promise((e,t)=>{let a=new FileReader;a.onloadend=()=>e(a.result),a.onerror=t,a.readAsDataURL(m.image)}));let{image:r,...s}=m,i={...s,Image:a,ID_category:parseInt(s.ID_category),Box_quantity:parseInt(s.Box_quantity)};console.log("Envoi du produit:",i),await (0,u.W)(i),t(),h({Label:"",Barcode:"",Box_quantity:0,Packing:!1,ID_category:0,Image:null}),l(null)};return(0,r.jsxs)("div",{className:"C-text-black flex flex-col w-[100vw] h-[70%] sm:w-[30vw] justify-center items-center sm:justify-between z-50",children:[(0,r.jsx)("div",{className:"p-4 absolute top-2 left-2 cursor-pointer",onClick:t,children:(0,r.jsx)("i",{className:"fa-solid fa-arrow-left-long text-3xl C-text-black","aria-hidden":"true"})}),(0,r.jsx)("div",{className:"w-[100%] flex justify-center items-center mt-[3vh]",children:(0,r.jsx)("h2",{className:"C-text-black font-bold text-2xl mb-6",children:"Cr\xe9ation produit"})}),(0,r.jsxs)("form",{onSubmit:v,className:"bg-white rounded-2xl flex flex-col justify-center items-center gap-5 p-6 w-[90%] max-w-md",children:[(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)("input",{type:"text",placeholder:"Label",className:"w-full border C-shadow-red-var2 C-border-red rounded-full p-2 mb-2",value:m.Label,onChange:e=>h({...m,Label:e.target.value}),required:!0})}),(0,r.jsxs)("div",{className:"flex justify-around items-center gap-5 w-full",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2 w-[50%] items-center justify-center",children:[(0,r.jsx)("div",{className:"w-full",children:(0,r.jsx)("input",{type:"text",placeholder:"Code barre",className:"w-full border C-shadow-red-var2 C-border-red rounded-full p-2 mb-2",value:m.Barcode,onChange:e=>h({...m,Barcode:e.target.value}),minLength:13,maxLength:13,required:!0})}),(0,r.jsxs)("div",{className:"w-full flex justify-between items-center gap-2",children:[(0,r.jsx)("label",{htmlFor:"boxQty",children:"Nombre par carton"}),(0,r.jsx)("input",{type:"number",id:"boxQty",placeholder:"0",className:"border C-shadow-red-var2 C-border-red rounded-xl p-2 w-[50%]",value:m.Box_quantity,onChange:e=>h({...m,Box_quantity:parseInt(e.target.value)}),min:0,required:!0})]}),(0,r.jsxs)("div",{className:"w-full flex items-center gap-3",children:[(0,r.jsx)("label",{htmlFor:"vrac",className:"font-semibold",children:"Vrac ?"}),(0,r.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",id:"vrac",checked:m.Packing,onChange:e=>h({...m,Packing:e.target.checked}),className:"sr-only peer"}),(0,r.jsx)("div",{className:"w-[4vh] h-[4vh] rounded-xl border-2 flex items-center justify-center transition-all duration-200 ".concat(m.Packing?"C-bg-red C-border-red":"C-border-red"),children:m.Packing&&(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-white"})})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2 w-[50%] h-full items-center justify-center",children:[(0,r.jsxs)("div",{className:"border C-border-red w-full C-shadow-red-var2 flex justify-center items-center rounded-xl text-center text-sm text-gray-600 h-[20vh] cursor-pointer overflow-hidden relative",children:[(0,r.jsx)("label",{htmlFor:"file-upload",className:"absolute inset-0 z-10 cursor-pointer"}),s?(0,r.jsx)("img",{src:s,alt:"Aper\xe7u",className:"w-full h-full object-cover rounded-xl"}):(0,r.jsx)("span",{className:"z-0",children:"Photo"})]}),(0,r.jsx)("input",{id:"file-upload",ref:f,type:"file",accept:"image/*",onChange:g,className:"hidden",required:!0})]})]}),(0,r.jsx)("div",{className:"w-full flex justify-center items-center gap-2",children:(0,r.jsxs)("select",{value:m.ID_category,onChange:e=>h({...m,ID_category:e.target.value}),className:"w-full border C-shadow-red-var2 C-border-red rounded-full p-2 mb-4",required:!0,children:[(0,r.jsx)("option",{value:"",children:"Cat\xe9gorie"}),n.map(e=>{var t;return(0,r.jsx)("option",{value:e.ID_category,children:(null===(t=e.category)||void 0===t?void 0:t.Label)||"Sans nom"},e.ID_category)})]})}),(0,r.jsx)("div",{className:"w-full flex justify-center items-center gap-2",children:(0,r.jsx)("button",{type:"submit",className:"w-full C-bg-red text-xl cursor-pointer text-white py-3 rounded-[20px] font-bold",children:"Ajouter"})})]})]})}var m=a(760),h=a(6129),f=a(1973),g=a(1811);function v(){let[e,t]=(0,i.useState)(!1),a=()=>t(!0),s=()=>t(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col gap-[5vh] items-center justify-center relative z-10 text-white w-[100%] p-5",children:[(0,r.jsx)("div",{className:"w-[100%]",children:(0,r.jsx)(n.A,{path:"/"})}),(0,r.jsxs)("div",{className:"flex flex-col items-start justify-start w-[100%]",children:[(0,r.jsx)("h2",{className:"C-text-black font-bold text-2xl mb-6",children:"Navigation"}),(0,r.jsxs)("div",{className:"flex flex-col gap-5 items-start justify-start sm:items-center w-[100%]",children:[(0,r.jsxs)("div",{onClick:()=>a(!0),className:"flex items-center cursor-pointer justify-around w-[100%] sm:w-[50%] h-[12vh] C-bg-red-var2 rounded-[20px] p-4 overflow-hidden relative",children:[(0,r.jsx)("i",{className:"fa-solid fa-boxes-stacked C-text-red-var1 text-5xl","aria-hidden":"true"}),(0,r.jsx)("p",{className:"C-text-black font-bold text-2xl",children:"Cr\xe9ation produits"}),(0,r.jsx)("div",{className:"flex items-end h-[100%] relative z-20",children:(0,r.jsx)("i",{className:"fa-solid fa-arrow-right-long C-text-black text-3xl","aria-hidden":"true"})}),(0,r.jsx)("img",{src:"/images/elements/barcode_var2.svg",className:"absolute w-[25vw] right-[20vw] sm:w-[8vw] bottom-0 z-10"})]}),(0,r.jsxs)(l(),{href:"/categories",className:"flex items-center justify-around w-[100%] sm:w-[50%] h-[12vh] C-bg-red-var2 rounded-[20px] p-4 overflow-hidden relative",children:[(0,r.jsx)("i",{className:"fa-solid fa-clipboard-list C-text-red-var1 text-5xl","aria-hidden":"true"}),(0,r.jsx)("p",{className:"C-text-black font-bold text-2xl",children:"Cat\xe9gories"}),(0,r.jsx)("div",{className:"flex items-end h-[100%] relative z-20",children:(0,r.jsx)("i",{className:"fa-solid fa-arrow-right-long C-text-black text-3xl","aria-hidden":"true"})}),(0,r.jsx)("img",{src:"/images/elements/vague_var2.svg",className:"absolute w-[15vw] sm:w-[5vw] right-0 top-0 z-10"})]}),(0,r.jsxs)(l(),{href:"/messages",className:"flex items-center justify-around w-[100%] sm:w-[50%] h-[12vh] C-bg-red-var2 rounded-[20px] p-4 overflow-hidden relative",children:[(0,r.jsx)("i",{className:"fa-solid fa-message C-text-red-var1 text-5xl","aria-hidden":"true"}),(0,r.jsx)("p",{className:"C-text-black font-bold text-2xl",children:"Messages"}),(0,r.jsx)("div",{className:"flex items-end h-[100%] relative z-20",children:(0,r.jsx)("i",{className:"fa-solid fa-arrow-right-long C-text-black text-3xl","aria-hidden":"true"})}),(0,r.jsx)("img",{src:"/images/elements/cercle_var2.svg",className:"absolute right-0 bottom-0 z-10"})]})]})]})]}),(0,r.jsx)(m.N,{children:e&&(0,r.jsx)(f.Y,{isOpen:e,onClose:s,hideCloseButton:!0,backdrop:"opaque",children:(0,r.jsx)(g.g,{as:h.P.div,className:"bg-white fixed rounded-t-[40px] bottom-0 left-0 sm:right-0 sm:left-auto min-w-min h-[70vh] sm:h-[100vh] pt-[2vh]",initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{duration:.3,ease:"easeOut"},children:(0,r.jsx)(x,{closeModal:s})})})})]})}},8157:(e,t,a)=>{Promise.resolve().then(a.bind(a,7936))},9142:(e,t,a)=>{"use strict";a.d(t,{O5:()=>n,QF:()=>o,c4:()=>c,iD:()=>i});var r=a(7383);let{fetchData:s}=a(9360),l="auth_token";async function i(e,t){try{let a=await s("/login",{method:"POST",body:JSON.stringify({Name:e,Password:t})});return n(a.token),await a}catch(e){return null}}function n(e){r.A.set(l,e,{expires:1,sameSite:"Strict"}),r.A.set("pendingProducts",[])}function c(){return r.A.get(l)}function o(){r.A.remove(l)}},9360:(e,t,a)=>{"use strict";a.r(t),a.d(t,{fetchData:()=>s});var r=a(9142);async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a=(0,r.c4)(),s=await fetch("".concat("https://relay-api.mathis-mercier.mds-angers.yt/api").concat(e),{...t,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:a?"Bearer ".concat(a):""},credentials:"include"});if(!s.ok)throw Error("Erreur HTTP! Statut: ".concat(s.status));return s.json()}catch(e){return null}}},9402:(e,t,a)=>{"use strict";a.d(t,{A:()=>o,O:()=>c});var r=a(5155),s=a(2115),l=a(9142),i=a(5695);let n=(0,s.createContext)();function c(e){let{children:t}=e,[a,c]=(0,s.useState)(null),[o,d]=(0,s.useState)((0,l.c4)()),u=(0,i.useRouter)();(0,s.useEffect)(()=>{{let e=localStorage.getItem("user");e&&c(JSON.parse(e))}},[]),(0,s.useEffect)(()=>{o||u.push("/login")},[o]);let x=async(e,t)=>{let a=await (0,l.iD)(e,t);a&&a.token&&((0,l.O5)(a.token),c(a.user),d(a.token),localStorage.setItem("user",JSON.stringify(a.user)),u.push("/"))};return(0,r.jsx)(n.Provider,{value:{user:a,token:o,login:x,logout:()=>{(0,l.QF)(),c(null),d(null),localStorage.removeItem("user"),u.push("/login")}},children:t})}function o(){return(0,s.useContext)(n)}}},e=>{var t=t=>e(e.s=t);e.O(0,[806,562,94,663,802,441,684,358],()=>t(8157)),_N_E=e.O()}]);