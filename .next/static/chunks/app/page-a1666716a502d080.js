(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1210:(e,t,s)=>{"use strict";s.d(t,{NI:()=>l,yW:()=>r,yb:()=>n});let{fetchData:a}=s(9360);async function r(e){try{let t=await a("/stock/".concat(e),{method:"GET"});return console.log("Stocks:",t),await t}catch(e){return null}}async function l(e,t){try{let s=await a("/stocks/".concat(e),{method:"PUT",body:JSON.stringify({stocks:t})});return await s}catch(e){return null}}async function i(e){try{let t=await a("/stocks",{method:"POST",body:JSON.stringify({stocks:e})});return await t}catch(e){return null}}async function n(e,t){try{let s=await r(e),a={};s.forEach(e=>{a[e.ID_product]=e});let n=[],c=[];return t.forEach(t=>{let s=parseInt(t.Quantity)*t.Box_quantity,r=a[t.ID_product];r?0===t.Packing?n.push({ID_product:t.ID_product,Quantity:r.Quantity+s,Nmb_boxes:r.Nmb_boxes+parseInt(t.Quantity),Nmb_on_shelves:r.Nmb_on_shelves}):n.push({ID_product:t.ID_product,Quantity:r.Quantity,Nmb_boxes:r.Nmb_boxes+parseInt(t.Quantity),Nmb_on_shelves:r.Nmb_on_shelves}):0===t.Packing?c.push({ID_product:t.ID_product,ID_store:e,Quantity:s,Nmb_boxes:parseInt(t.Quantity),Nmb_on_shelves:0}):c.push({ID_product:t.ID_product,ID_store:e,Quantity:0,Nmb_boxes:parseInt(t.Quantity),Nmb_on_shelves:0})}),n.length>0&&await l(e,n),c.length>0&&await i(c),await r(e)}catch(e){return console.error("Erreur lors de l'ajout au stock :",e),null}}},1756:(e,t,s)=>{"use strict";s.d(t,{b:()=>r});let{fetchData:a}=s(9360);async function r(e){try{let t=await a("/categoryEnable/".concat(e),{method:"GET"});return await t}catch(e){return null}}},3727:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(5155);function r(){return(0,a.jsx)("div",{className:"w-[100vw] C-bg-white flex items-center justify-center my-[2vh]",children:(0,a.jsx)("div",{className:"w-[30px] h-[30px] C-bg-red rounded-full p-1.5",children:(0,a.jsx)("img",{src:"/images/elements/logo-relay.svg",className:"w-[100%] h-[100%]"})})})}},3821:(e,t,s)=>{Promise.resolve().then(s.bind(s,8625))},5068:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var a=s(5155);function r(){return(0,a.jsx)("div",{className:"h-[1px] w-[100%] C-bg-red-var2"})}},6713:(e,t,s)=>{"use strict";s.d(t,{U:()=>r});var a=s(2115);function r(e){let[t,s]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let t=window.matchMedia(e);s(t.matches);let a=e=>s(e.matches);return t.addEventListener("change",a),()=>t.removeEventListener("change",a)},[e]),t}},8625:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var a=s(5155),r=s(5068),l=s(9402),i=s(6874),n=s.n(i),c=s(2115),o=s(6713),d=s(1210),u=s(1756),x=s(3727),h=s(760),m=s(6129);let{fetchData:f}=s(9360);async function v(e){try{let t=await f("/messages/".concat(e),{method:"GET"});return await t}catch(e){return null}}function g(e){let{storeId:t}=e,[s,r]=(0,c.useState)([]),[l,i]=(0,c.useState)(0);return(0,c.useEffect)(()=>{(async()=>{r(await v(t))})()},[t]),(0,a.jsxs)("div",{className:"relative flex flex-col items-center w-[90vw] max-w-lg mx-auto p-4 C-bg-red rounded-[20px]",children:[(0,a.jsx)("div",{className:"absolute rounded-[30px] C-bg-red-var2 w-[85vw] h-[10vh] bottom-[-1vh] z-[-1]"}),(0,a.jsx)("div",{className:"text-white w-full rounded-3xl p-6 relative flex items-start",children:(0,a.jsx)(h.N,{mode:"wait",children:s.length>0&&(0,a.jsx)(m.P.p,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},transition:{duration:.5},className:"text-lg text-center text-wrap w-full break-words",children:s[l].Message},s[l].ID_message)})}),(0,a.jsx)("div",{className:"flex justify-center relative w-full h-[1px] mt-6 space-x-2",children:(0,a.jsx)("div",{className:"flex justify-center absolute bottom-[2vh] left-[5vw] mt-4 space-x-2",children:s.map((e,t)=>(0,a.jsx)("span",{className:"h-3 w-3 rounded-full border-white border-[2px] ".concat(t===l?"bg-white":"C-bg-red"," transition-all duration-300")},t))})}),(0,a.jsx)("button",{className:"absolute right-[15vw] bottom-0 transform -translate-y-1/2 text-white text-3xl",onClick:()=>{i(e=>(e-1+s.length)%s.length)},children:(0,a.jsx)("i",{className:"fa-solid fa-chevron-left","aria-hidden":"true"})}),(0,a.jsx)("button",{className:"absolute right-[5vw] bottom-0 transform -translate-y-1/2 text-white text-3xl",onClick:()=>{i(e=>(e+1)%s.length)},children:(0,a.jsx)("i",{className:"fa-solid fa-chevron-right","aria-hidden":"true"})})]})}function p(e){let{storeId:t}=e,[s,r]=(0,c.useState)([]),[l,i]=(0,c.useState)(0);return(0,c.useEffect)(()=>{(async()=>{t&&r(await v(t))})()},[t]),(0,a.jsxs)("div",{className:"relative w-[90%] flex justify-center items-center mt-5",children:[(0,a.jsx)("button",{onClick:()=>{i(e=>e-3<0?s.length-3:e-3)},className:"absolute left-0 z-10 C-bg-red text-white w-[40px] h-[40px] p-3 rounded-full flex justify-center items-center shadow-md transition",children:(0,a.jsx)("i",{className:"fa-solid fa-chevron-left text-2xl","aria-hidden":"true"})}),(0,a.jsx)("div",{className:"overflow-hidden py-5 w-[80%]",children:(0,a.jsx)(h.N,{mode:"wait",children:(0,a.jsx)(m.P.div,{className:"flex gap-5",initial:{opacity:0,x:-50},animate:{opacity:1,x:0},exit:{opacity:0,x:50},transition:{duration:.5},children:s.slice(l,l+3).map((e,t)=>(0,a.jsxs)("div",{className:"C-bg-red text-white flex flex-col items-center p-5 rounded-[20px] w-[30%] relative",children:[(0,a.jsx)("div",{className:"absolute rounded-[30px] C-bg-red-var2 w-[90%] h-[5vh] bottom-[-1vh] z-[-1]"}),(0,a.jsx)("p",{className:"text-lg",children:e.Message})]},t))},l)})}),(0,a.jsx)("button",{onClick:()=>{i(e=>(e+3)%s.length)},className:"absolute right-0 z-10 C-bg-red text-white w-[40px] h-[40px] p-3 rounded-full flex justify-center items-center shadow-md transition",children:(0,a.jsx)("i",{className:"fa-solid fa-chevron-right text-2xl","aria-hidden":"true"})})]})}function b(){let[e,t]=(0,c.useState)([]),[s,i]=(0,c.useState)([]),[h,m]=(0,c.useState)([]),{user:f}=(0,l.A)();(0,c.useEffect)(()=>{(async()=>{if(f&&f.ID_store){let e=await (0,d.yW)(f.ID_store),s=await (0,u.b)(f.ID_store);t(e),i(s),m(function(e,t){let s=[],a=0,r=0;return e.forEach(e=>{a+=e.Nmb_boxes}),t.forEach(t=>{let l=e.filter(e=>e.product.ID_category===t.category.ID_category).reduce((e,t)=>e+t.Nmb_boxes,0);l>0&&(r+=l/a*100,s.push({categorie:t.category.Label,totalBoites:l,startPercentage:r}))}),s}(e,s))}})()},[f]);let v=(0,o.U)("(max-width: 768px)"),b=["#FF6384","#36A2EB","#FFCE56","#4CAF50","#9C27B0"];return(0,a.jsxs)("div",{className:"flex flex-col gap-[5vh] items-center justify-center relative z-10 text-white w-[100%] p-5",children:[v?(0,a.jsx)(g,{storeId:null==f?void 0:f.ID_store}):(0,a.jsx)(p,{storeId:null==f?void 0:f.ID_store}),v?(0,a.jsxs)("div",{className:"flex flex-col items-start justify-start w-[100%]",children:[(0,a.jsx)("h2",{className:"C-text-black font-bold text-2xl mb-6",children:"Navigation"}),(0,a.jsxs)("div",{className:"flex flex-col gap-5 items-start justify-start w-[100%]",children:[(0,a.jsxs)(n(),{href:"/stocks",className:"flex items-center justify-around w-[100%] h-[12vh] C-bg-red-var2 rounded-[20px] p-4 overflow-hidden relative",children:[(0,a.jsx)("i",{className:"fa-solid fa-boxes-stacked C-text-red-var1 text-5xl","aria-hidden":"true"}),(0,a.jsx)("p",{className:"C-text-black font-bold text-2xl",children:"Stocks"}),(0,a.jsx)("div",{className:"flex items-end h-[100%] relative z-20",children:(0,a.jsx)("i",{className:"fa-solid fa-arrow-right-long C-text-black text-3xl","aria-hidden":"true"})}),(0,a.jsx)("img",{src:"/images/elements/cercle_var2.svg",className:"absolute right-0 bottom-0 z-10"})]}),(0,a.jsxs)(n(),{href:"/listes",className:"flex items-center justify-around w-[100%] h-[12vh] C-bg-red-var2 rounded-[20px] p-4 overflow-hidden relative",children:[(0,a.jsx)("i",{className:"fa-solid fa-clipboard-list C-text-red-var1 text-5xl","aria-hidden":"true"}),(0,a.jsx)("p",{className:"C-text-black font-bold text-2xl",children:"Listes"}),(0,a.jsx)("div",{className:"flex items-end h-[100%] relative z-20",children:(0,a.jsx)("i",{className:"fa-solid fa-arrow-right-long C-text-black text-3xl","aria-hidden":"true"})}),(0,a.jsx)("img",{src:"/images/elements/vague_var2.svg",className:"absolute w-[15vw] right-0 top-0 z-10"})]}),(0,a.jsxs)(n(),{href:"/configuration",className:"flex items-center justify-around w-[100%] h-[12vh] C-bg-red-var2 rounded-[20px] p-4 overflow-hidden relative",children:[(0,a.jsx)("i",{className:"fa-solid fa-gears C-text-red-var1 text-5xl","aria-hidden":"true"}),(0,a.jsx)("p",{className:"C-text-black font-bold text-2xl",children:"Configuration"}),(0,a.jsx)("div",{className:"flex items-end h-[100%] relative z-20",children:(0,a.jsx)("i",{className:"fa-solid fa-arrow-right-long C-text-black text-3xl","aria-hidden":"true"})}),(0,a.jsx)("img",{src:"/images/elements/barcode_var2.svg",className:"absolute w-[25vw] right-[20vw] bottom-0 z-10"})]}),(0,a.jsxs)(n(),{href:"/a-propos",className:"flex items-center justify-around w-[100%] h-[12vh] C-bg-red-var2 rounded-[20px] p-4 overflow-hidden relative",children:[(0,a.jsx)("i",{className:"fa-solid fa-store C-text-red-var1 text-5xl","aria-hidden":"true"}),(0,a.jsx)("p",{className:"C-text-black font-bold text-2xl",children:"A propos"}),(0,a.jsx)("div",{className:"flex items-end h-[100%] relative z-20",children:(0,a.jsx)("i",{className:"fa-solid fa-arrow-right-long C-text-black text-3xl","aria-hidden":"true"})}),(0,a.jsx)("img",{src:"/images/elements/rond_var2.svg",className:"absolute right-[50vw] top-0 z-10"})]})]})]}):(0,a.jsx)(a.Fragment,{}),(0,a.jsx)(r.A,{}),(0,a.jsxs)("div",{className:"flex flex-col items-start justify-start w-[100%]",children:[(0,a.jsx)("h2",{className:"C-text-black font-bold text-2xl mb-6",children:"Etat du stock"}),(0,a.jsxs)("div",{className:"w-[100%] h-[100%] flex flex-col items-center justify-center gap-5",children:[(0,a.jsx)("div",{className:"relative w-[100%] sm:w-[70%] h-[25px] bg-gray-300 rounded-full overflow-hidden",children:h.map((e,t)=>(0,a.jsx)("div",{className:"absolute top-0 h-full rounded-r-[20px]",style:{width:"".concat(e.startPercentage,"%"),backgroundColor:b[t%b.length],zIndex:h.length-t}},t))}),(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 mt-6",children:h.map((e,t)=>(0,a.jsxs)("div",{className:"p-4 rounded-[20px] shadow-md bg-white flex flex-col gap-5 items-center justify-center border-t-[5px] w-[45vw] sm:w-[20vw] h-[12vh]",style:{borderColor:b[t%b.length]},children:[(0,a.jsx)("p",{className:"text-xl font-bold C-text-black",children:e.categorie}),(0,a.jsxs)("p",{className:"text-2xl font-bold",style:{color:b[t%b.length]},children:[e.totalBoites," ",(0,a.jsx)("span",{className:"text-xl C-text-black",children:"boites"})]})]},t))})]})]}),(0,a.jsx)(x.A,{})]})}},9142:(e,t,s)=>{"use strict";s.d(t,{O5:()=>n,QF:()=>o,c4:()=>c,iD:()=>i});var a=s(7383);let{fetchData:r}=s(9360),l="auth_token";async function i(e,t){try{let s=await r("/login",{method:"POST",body:JSON.stringify({Name:e,Password:t})});return n(s.token),await s}catch(e){return null}}function n(e){a.A.set(l,e,{expires:1,sameSite:"Strict"}),a.A.set("pendingProducts",[])}function c(){return a.A.get(l)}function o(){a.A.remove(l)}},9360:(e,t,s)=>{"use strict";s.r(t),s.d(t,{fetchData:()=>r});var a=s(9142);async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let s=(0,a.c4)(),r=await fetch("".concat("https://relay-api.mathis-mercier.mds-angers.yt/api").concat(e),{...t,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:s?"Bearer ".concat(s):""},credentials:"include"});if(!r.ok)throw Error("Erreur HTTP! Statut: ".concat(r.status));return r.json()}catch(e){return null}}},9402:(e,t,s)=>{"use strict";s.d(t,{A:()=>o,O:()=>c});var a=s(5155),r=s(2115),l=s(9142),i=s(5695);let n=(0,r.createContext)();function c(e){let{children:t}=e,[s,c]=(0,r.useState)(null),[o,d]=(0,r.useState)((0,l.c4)()),u=(0,i.useRouter)();(0,r.useEffect)(()=>{{let e=localStorage.getItem("user");e&&c(JSON.parse(e))}},[]),(0,r.useEffect)(()=>{o||u.push("/login")},[o]);let x=async(e,t)=>{let s=await (0,l.iD)(e,t);s&&s.token&&((0,l.O5)(s.token),c(s.user),d(s.token),localStorage.setItem("user",JSON.stringify(s.user)),u.push("/"))};return(0,a.jsx)(n.Provider,{value:{user:s,token:o,login:x,logout:()=>{(0,l.QF)(),c(null),d(null),localStorage.removeItem("user"),u.push("/login")}},children:t})}function o(){return(0,r.useContext)(n)}}},e=>{var t=t=>e(e.s=t);e.O(0,[806,562,441,684,358],()=>t(3821)),_N_E=e.O()}]);