(()=>{var e={};e.id=952,e.ids=[952],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1172:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(687);function a(){return(0,r.jsx)("div",{className:"h-[1px] w-[100%] C-bg-red-var2"})}},2610:(e,t,s)=>{"use strict";s.d(t,{b:()=>a});let{fetchData:r}=s(2744);async function a(e){try{let t=await r(`/categoryEnable/${e}`,{method:"GET"});return await t}catch(e){return null}}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3270:(e,t,s)=>{"use strict";s.d(t,{NI:()=>l,yW:()=>a,yb:()=>i});let{fetchData:r}=s(2744);async function a(e){try{let t=await r(`/stock/${e}`,{method:"GET"});return console.log("Stocks:",t),await t}catch(e){return null}}async function l(e,t){try{let s=await r(`/stocks/${e}`,{method:"PUT",body:JSON.stringify({stocks:t})});return await s}catch(e){return null}}async function n(e){try{let t=await r("/stocks",{method:"POST",body:JSON.stringify({stocks:e})});return await t}catch(e){return null}}async function i(e,t){try{let s=await a(e),r={};s.forEach(e=>{r[e.ID_product]=e});let i=[],c=[];return t.forEach(t=>{let s=parseInt(t.Quantity)*t.Box_quantity,a=r[t.ID_product];a?0===t.Packing?i.push({ID_product:t.ID_product,Quantity:a.Quantity+s,Nmb_boxes:a.Nmb_boxes+parseInt(t.Quantity),Nmb_on_shelves:a.Nmb_on_shelves}):i.push({ID_product:t.ID_product,Quantity:a.Quantity,Nmb_boxes:a.Nmb_boxes+parseInt(t.Quantity),Nmb_on_shelves:a.Nmb_on_shelves}):0===t.Packing?c.push({ID_product:t.ID_product,ID_store:e,Quantity:s,Nmb_boxes:parseInt(t.Quantity),Nmb_on_shelves:0}):c.push({ID_product:t.ID_product,ID_store:e,Quantity:0,Nmb_boxes:parseInt(t.Quantity),Nmb_on_shelves:0})}),i.length>0&&await l(e,i),c.length>0&&await n(c),await a(e)}catch(e){return console.error("Erreur lors de l'ajout au stock :",e),null}}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3575:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,pages:()=>d,routeModule:()=>u,tree:()=>o});var r=s(5239),a=s(8088),l=s(8170),n=s.n(l),i=s(893),c={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);s.d(t,c);let o={children:["",{children:["listes",{children:["create",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8316)),"C:\\Users\\mthsm\\Documents\\Relay\\Relay-PWA\\src\\app\\listes\\create\\page.jsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,9769)),"C:\\Users\\mthsm\\Documents\\Relay\\Relay-PWA\\src\\app\\layout.jsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["C:\\Users\\mthsm\\Documents\\Relay\\Relay-PWA\\src\\app\\listes\\create\\page.jsx"],x={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/listes/create/page",pathname:"/listes/create",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},3873:e=>{"use strict";e.exports=require("path")},4798:(e,t,s)=>{"use strict";s.d(t,{Bv:()=>l,D1:()=>n,I:()=>c,JR:()=>a,cd:()=>i});let{fetchData:r}=s(2744);async function a(e){try{let t=await r(`/list/${e}`,{method:"GET"});return await t}catch(e){return null}}async function l(e,t){try{let s=await r(`/list/${e}/${t}`,{method:"GET"});return await s}catch(e){return null}}async function n(e,t){let s={ID_store:e,products:Object.entries(t=Object.fromEntries(Object.entries(t).filter(([e,t])=>t.items>0&&"N/A"!==t.items))).map(([e,t])=>({ID_product:parseInt(e),Quantity:t.items}))};try{console.log("Creating list with data:",s);let e=await r("/list",{method:"POST",body:JSON.stringify(s)});return await e}catch(e){return console.log("Error creating list:",e),null}}async function i(e,t){try{t=Object.fromEntries(Object.entries(t).filter(([e,t])=>t>0&&"N/A"!==t));let s=Object.entries(t).map(([e,t])=>({ID_product:parseInt(e),Quantity:t})),a=await r("/list",{method:"PUT",body:JSON.stringify({ID_list:e,products:s})});return await a}catch(e){return console.log("Error updating list:",e),null}}async function c(e){try{let t=await r("/list",{method:"DELETE",body:JSON.stringify({ID_list:e})});return await t}catch(e){return null}}},5107:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(687),a=s(5814),l=s.n(a);function n({path:e}){return(0,r.jsx)("div",{children:(0,r.jsx)(l(),{href:e,className:"p-4",children:(0,r.jsx)("i",{className:"fa-solid fa-arrow-left-long text-3xl C-text-black","aria-hidden":"true"})})})}},5463:(e,t,s)=>{Promise.resolve().then(s.bind(s,8733))},7215:(e,t,s)=>{Promise.resolve().then(s.bind(s,8316))},8316:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\mthsm\\\\Documents\\\\Relay\\\\Relay-PWA\\\\src\\\\app\\\\listes\\\\create\\\\page.jsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\mthsm\\Documents\\Relay\\Relay-PWA\\src\\app\\listes\\create\\page.jsx","default")},8733:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var r=s(687),a=s(5107),l=s(3210);s(3270),s(2610);var n=s(5216),i=s(1172),c=s(4343);function o({stocks:e,list:t,setList:s}){let[a,n]=(0,l.useState)(Array(e.length).fill(!1)),i=(e,r)=>{let l=[...a];if(l[e]=!l[e],n(l),l[e]){let e=r.ID_product,a=t[e]?.items||0;s(t=>({...t,[e]:{...t[e],items:a+1}}))}},c=(e,t,r)=>{s(s=>{let{boxes:a,items:l}=s[e]||{boxes:0,items:0};return"boxes"===t?l=(a=Math.max(0,a+r))*o(e):a=Math.floor((l=Math.max(0,l+r))/o(e)),{...s,[e]:{boxes:a,items:l}}})},o=t=>e.find(e=>e.ID_product===t)?.product.Box_quantity||1;return e&&0!==e.length?(0,r.jsx)("div",{className:"w-full flex flex-col items-center mt-2",children:(0,r.jsx)("div",{className:"w-[90%] flex flex-col items-center gap-2",children:e.map((e,s)=>{let l=e.ID_product,n=o(l),d=t[l]?.boxes||0,x=t[l]?.items||0;return(0,r.jsxs)("div",{className:"bg-white w-[90%] flex rounded-[10px] border-[2px] C-border-red mb-2 overflow-hidden transition-all duration-300",children:[(0,r.jsxs)("div",{className:"w-[80%] flex gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center h-full w-[50%]",children:[(0,r.jsx)("div",{className:"flex items-center justify-center h-full gap-3 border-black border-r-[1px] w-[30%]",children:(0,r.jsx)("img",{src:e.product.Image||"/images/elements/default-product.jpg",alt:e.product?.Label,className:"w-auto h-full rounded-[10px] object-cover"})}),(0,r.jsxs)("div",{className:"flex flex-col justify-between items-start w-[85%] h-[70%] py-3 px-2 pr-4",children:[(0,r.jsx)("p",{className:"C-text-black font-semibold text-xl",children:e.product?.Label}),(0,r.jsx)("p",{className:"C-text-black font-normal text-sm",children:e.product?.Barcode})]})]}),(0,r.jsx)("div",{className:"flex items-center gap-3 pl-5 text-lg justify-between w-[50%] p-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-1 w-full justify-between",children:[0===e.product.Packing?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"fa-solid fa-cash-register text-2xl C-text-red"}),(0,r.jsx)("span",{className:"C-text-black font-bold",children:e.Nmb_on_shelves})]}):(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"fa-solid fa-box-open text-2xl C-text-red"}),(0,r.jsx)("input",{type:"checkbox",className:"w-5 h-5",disabled:!0,checked:1===e.product.Packing})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,r.jsx)("i",{className:"fa-solid fa-boxes-stacked C-text-red text-2xl"}),(0,r.jsx)("p",{className:"C-text-black font-bold",children:n})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"fa-solid fa-box text-2xl C-text-red"}),(0,r.jsx)("span",{className:"C-text-black font-bold",children:e.Nmb_boxes})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("i",{className:"fa-solid fa-dolly text-2xl C-text-red"}),(0,r.jsx)("span",{className:"C-text-black font-bold",children:e.Quantity})]})]})})]}),(0,r.jsx)("div",{className:"C-border-red-var2 border-l-[1px] p-4 w-[20%] min-w-max h-full",children:(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"fa-solid fa-box text-2xl C-text-red"}),(0,r.jsx)("button",{className:"C-bg-red w-[4vh] h-[4vh] text-white rounded-xl",onClick:()=>c(l,"boxes",-1),children:"-1"}),(0,r.jsx)("input",{name:"QuantityBoxes",type:"number",className:"text-center text-xl font-bold C-text-black border w-[5vh] h-[5vh] C-border-red rounded-xl",value:d,onChange:e=>c(l,"boxes",e.target.value-d)}),(0,r.jsx)("button",{className:"C-bg-red w-[4vh] h-[4vh] text-white rounded-xl",onClick:()=>c(l,"boxes",1),children:"+1"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"fa-solid fa-dolly text-2xl C-text-red"}),0===e.product.Packing?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:"C-bg-red w-[4vh] h-[4vh] text-white rounded-xl",onClick:()=>c(l,"items",-1),children:"-1"}),(0,r.jsx)("input",{name:"QuantityItems",type:"number",onChange:e=>c(l,"items",e.target.value-x),className:"text-center text-xl font-bold C-text-black border w-[5vh] h-[5vh] C-border-red rounded-xl",value:x}),(0,r.jsx)("button",{className:"C-bg-red w-[4vh] h-[4vh] text-white rounded-xl",onClick:()=>c(l,"items",1),children:"+1"})]}):(0,r.jsxs)("label",{className:"relative inline-flex items-center gap-3 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:a[s],onChange:()=>i(s,e),className:"sr-only"}),(0,r.jsx)("div",{className:`w-[4vh] h-[4vh] rounded-xl border-2 flex items-center justify-center transition-all duration-200 ${a[s]?"C-bg-red C-border-red":"C-border-red"}`,children:a[s]&&(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-white"})})]})]})]})})]},l)})})}):(0,r.jsx)("p",{className:"text-white text-center",children:"Aucun produit trouv\xe9."})}function d({stocks:e,list:t,setList:s}){let[a,n]=(0,l.useState)(null),i=e=>n(t=>t===e?null:e),[c,o]=(0,l.useState)(Array(e.length).fill(!1)),d=(e,r)=>{let a=[...c];if(a[e]=!a[e],o(a),a[e]){let e=r.ID_product,a=t[e]?.items||0;s(t=>({...t,[e]:{...t[e],items:a+1}}))}},x=(e,t,r)=>{s(s=>{let{boxes:a,items:l}=s[e]||{boxes:0,items:0};return"boxes"===t?l=(a=Math.max(0,a+r))*u(e):a=Math.floor((l=Math.max(0,l+r))/u(e)),{...s,[e]:{boxes:a,items:l}}})},u=t=>e.find(e=>e.ID_product===t)?.product.Box_quantity||1;return e&&0!==e.length?(0,r.jsx)("div",{className:"w-full flex flex-col justify-start items-center mt-2",children:e.map((e,s)=>{let l=e.ID_product,n=u(l),o=t[l]?.boxes||0,m=t[l]?.items||0;return(0,r.jsxs)("div",{className:"bg-white w-[90%] rounded-[10px] border-[2px] C-border-red mb-2 overflow-hidden transition-all duration-300",children:[(0,r.jsxs)("div",{className:"flex cursor-pointer h-[8vh] min-h-max",onClick:()=>{i(e.ID_stock)},children:[(0,r.jsx)("div",{className:"flex items-center justify-center h-full gap-3 w-[15%]",children:(0,r.jsx)("img",{src:e.product.Image||"/images/elements/default-product.jpg",alt:e.product?.Label,className:"w-auto h-auto rounded-[10px] object-cover"})}),(0,r.jsxs)("div",{className:"flex justify-between border-black border-l-[1px] items-center w-[85%] h-full py-3 px-2 pr-4",children:[(0,r.jsxs)("div",{className:"w-[60%]",children:[(0,r.jsx)("p",{className:"C-text-black font-semibold text-xl",children:e.product?.Label}),(0,r.jsx)("p",{className:"C-text-black font-normal text-sm",children:e.product?.Barcode})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-3 text-lg justify-between w-[50%]",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 w-full justify-between",children:[0===e.product.Packing?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"fa-solid fa-cash-register text-2xl C-text-red"}),(0,r.jsx)("span",{className:"C-text-black font-bold",children:e.Nmb_on_shelves})]}):(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"fa-solid fa-box-open text-2xl C-text-red"}),(0,r.jsx)("input",{type:"checkbox",className:"w-5 h-5",disabled:!0,checked:1===e.product.Packing})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,r.jsx)("i",{className:"fa-solid fa-boxes-stacked C-text-red text-2xl"}),(0,r.jsx)("p",{className:"C-text-black font-bold ",children:n})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1 w-full justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"fa-solid fa-box text-2xl C-text-red"}),(0,r.jsxs)("span",{className:"C-text-black font-bold",children:[e.Nmb_boxes,0===e.product.Packing&&e.Nmb_boxes*e.product.Box_quantity!==e.Quantity&&(0,r.jsx)("span",{className:"ml-1",children:"(1)"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("i",{className:"fa-solid fa-dolly text-2xl C-text-red"}),(0,r.jsx)("span",{className:"C-text-black font-bold",children:e.Quantity})]})]})]})]})]}),(0,r.jsx)("div",{className:`transition-all duration-300 ease-in-out overflow-hidden C-border-red-var2 border-t-[1px] ${a===e.ID_stock?"max-h-[200px] opacity-100":"max-h-0 opacity-0"}`,children:(0,r.jsx)("div",{className:"flex justify-around items-center px-2 py-3 border-t C-border-light",children:(0,r.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,r.jsx)("i",{className:"fa-solid fa-box text-2xl C-text-red"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>x(l,"boxes",-1),className:"C-bg-red w-[8vw] h-[8vw] text-white px-2 py-1 rounded-xl",children:"-1"}),(0,r.jsx)("input",{type:"number",className:"text-center text-xl font-bold C-text-black border w-[10vw] h-[10vw] C-border-red rounded-xl",value:o,onChange:e=>x(l,"boxes",e.target.value-o)}),(0,r.jsx)("button",{onClick:()=>x(l,"boxes",1),className:"C-bg-red w-[8vw] h-[8vw] text-white px-2 py-1 rounded-xl",children:"+1"})]}),(0,r.jsx)("i",{className:"fa-solid fa-dolly text-2xl C-text-red"}),0===e.product.Packing?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>x(l,"items",-1),className:"C-bg-red w-[8vw] h-[8vw] text-white px-2 py-1 rounded-xl",children:"-1"}),(0,r.jsx)("input",{type:"number",className:"text-center text-xl font-bold C-text-black border w-[10vw] h-[10vw] C-border-red rounded-xl",value:m,onChange:e=>x(l,"items",e.target.value-m)}),(0,r.jsx)("button",{onClick:()=>x(l,"items",1),className:"C-bg-red w-[8vw] h-[8vw] text-white px-2 py-1 rounded-xl",children:"+1"})]}):(0,r.jsxs)("label",{className:"relative inline-flex items-center gap-3 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:c[s],onChange:()=>d(s,e),className:"sr-only"}),(0,r.jsx)("div",{className:`w-[8vw] h-[8vw] rounded-xl border-2 flex items-center justify-center transition-all duration-200 ${c[s]?"C-bg-red C-border-red":"C-border-red"}`,children:c[s]&&(0,r.jsx)("div",{className:"w-3 h-3 rounded-full bg-white"})})]})]})})})]},e.ID_stock)})}):(0,r.jsx)("p",{className:"text-white text-center",children:"Aucun produit trouv\xe9."})}var x=s(4798);function u(){let[e,t]=(0,l.useState)([]),[s,u]=(0,l.useState)([]),[m,h]=(0,l.useState)([]),[p,f]=(0,l.useState)(null),[b,j]=(0,l.useState)(0),[v,N]=(0,l.useState)(0),[y,w]=(0,l.useState)(""),[g,C]=(0,l.useState)({}),k=(0,c.U)("(max-width: 768px)"),{user:_}=(0,n.A)(),I=["#FF6384","#36A2EB","#FFCE56","#4CAF50","#9C27B0"],D=async()=>{await (0,x.D1)(_.ID_store,g)&&(window.location.href="/listes")};return(0,r.jsxs)("div",{className:"flex flex-col gap-[3vh] items-center justify-start relative z-10 w-[100%] h-[100%] p-5",children:[(0,r.jsx)("div",{className:"w-[100%]",children:(0,r.jsx)(a.A,{path:"/listes"})}),(0,r.jsx)("div",{className:"w-full flex items-center justify-end px-5 py-3",children:(0,r.jsx)("div",{className:" C-text-red font-bold text-xl cursor-pointer C-bg-red-var2 rounded-full px-10 py-2",onClick:D,children:"Cr\xe9er"})}),(0,r.jsx)("div",{className:"flex items-center justify-start gap-3 w-[100%] px-4 overflow-x-auto h-[10vh] min-h-min scrollbar-hide",children:m.map((e,t)=>(0,r.jsx)("button",{onClick:()=>f(e.ID_category),className:`p-4 text-xl rounded-[20px] border-b-[5px] cursor-pointer transition-all bg-white ${p===e.ID_category?"!border-red-500 text-red-500 ":"border-gray-300 C-text-black "}`,style:{borderColor:I[t%I.length]},children:e.category.Label},e.ID_category))}),(0,r.jsxs)("div",{className:"flex items-center justify-around sm:justify-end sm:gap-8 w-full",children:[(0,r.jsxs)("div",{className:"flex items-center justify-start w-[60%] sm:w-auto gap-2",children:[(0,r.jsxs)("button",{onClick:()=>j(e=>1===e?-1:+(-1!==e)),className:"flex items-center gap-2 cursor-pointer text-black px-3 py-2",children:[1===b?(0,r.jsx)("i",{className:"fas fa-sort-up","aria-hidden":"true"}):-1===b?(0,r.jsx)("i",{className:"fas fa-sort-down","aria-hidden":"true"}):(0,r.jsx)("i",{className:"fas fa-sort","aria-hidden":"true"}),"Par nom"]}),(0,r.jsxs)("button",{onClick:()=>N(e=>1===e?-1:+(-1!==e)),className:"flex items-center gap-2 cursor-pointer text-black px-3 py-2",children:[1===v?(0,r.jsx)("i",{className:"fas fa-sort-up","aria-hidden":"true"}):-1===v?(0,r.jsx)("i",{className:"fas fa-sort-down","aria-hidden":"true"}):(0,r.jsx)("i",{className:"fas fa-sort","aria-hidden":"true"}),"Par quantit\xe9"]})]}),(0,r.jsxs)("div",{className:"relative w-[40%] sm:w-[20%] flex items-center ",children:[(0,r.jsx)("input",{type:"text",placeholder:"Recherche",value:y,onChange:e=>w(e.target.value),className:"px-4 py-2 C-border-red-var2 border-[1px] text-sm w-full rounded-full text-black shadow-md"}),(0,r.jsx)("i",{className:"fas fa-search absolute right-3 top-3 C-text-red","aria-hidden":"true"})]})]}),(0,r.jsx)(i.A,{}),(0,r.jsx)("div",{className:"w-full h-full flex flex-col justify-start items-center mt-2",children:0===s.length?(0,r.jsx)("p",{className:"text-white text-center",children:"Aucun produit trouv\xe9."}):k?(0,r.jsx)(d,{stocks:s,list:g,setList:C}):(0,r.jsx)(o,{stocks:s,list:g,setList:C})})]})}},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[518,281],()=>s(3575));module.exports=r})();